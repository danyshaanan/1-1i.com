<!DOCTYPE html>
<html lang=en>
<head>
<title>Dany Shaanan - Ford Circles</title>
<meta http-equiv='Content-Type' content='text/html; charset=utf-8' />
<meta name='googlebot' content='noarchive' />
<meta name='robots'    content='noarchive, nosnippet' />
<meta name='description' content='Ford Circles in JavaScript on Canvas' />
<style>
body { margin: 0px; padding: 0px; }
canvas { position:absolute; left:0px; top:0px; }
</style>
</head>
<body>

<canvas></canvas>

<script>
'use strict'

const range = (a, b) => [...Array(Math.abs(b-a)+1)].map((v, i) => a + Math.sign(b-a) * i)
const coprime = (a, b) => ~-a * ~-b ? a * b && coprime(b, a % b) : 1
const ctx = document.querySelector('canvas').getContext('2d')

const draw = (x, y, r) => {
	ctx.lineWidth = 2
	ctx.beginPath()
	ctx.arc(ctx.canvas.width * x, ctx.canvas.height - ctx.canvas.width * y, ctx.canvas.width * r, 0, 2 * Math.PI)
	ctx.stroke()
}


window.onload = window.onresize = _ => {
	ctx.canvas.width = document.documentElement.clientWidth
	ctx.canvas.height = document.documentElement.clientHeight
}

function frame() {
	ctx.canvas.width = ctx.canvas.width
	for (const q of range(0, 40))
		for (const p of range(0, q))
			coprime(p, q) && draw(p/q, .5/q**2, .5/q**2)
	window.requestAnimationFrame(frame)
}

window.requestAnimationFrame(frame)

</script>
<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-37601688-1', 'auto');
	ga('send', 'pageview');
</script>
</body>
</html>
